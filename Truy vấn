--Truy vấn
--a. Cho danh sách các hoá đơn lập trong năm 2020
select *from HOADON where YEAR(HOADON.NGAYLAP) =  2020

--b. Cho danh sách các khách hàng ở TPHCM
select *from KHACHHANG where KHACHHANG.TPHO like N'%Thành phố Hồ Chí Minh'

--c. Cho danh sách các sản phẩm có giá trong một khoảng từ 1000 đến 2000
select *from SANPHAM where SANPHAM.GIA >= 1000 and SANPHAM.GIA<=2000

--d. Cho danh sách các sản phẩm có số lượng tồn <100
select *from SANPHAM where SANPHAM.SOLUONGTON < 100
--e. Cho danh sách các sản phẩm bán chạy nhất (số lượng bán nhiều nhất)

select MASP,TENSP,SOLUONGTON,MOTA,GIA, SUM(soluong) as TongSL
from SANPHAM,CT_HOADON
where SANPHAM.MASP=CT_HOADON.MASP_CT
group by MASP,TENSP,SOLUONGTON,MOTA,GIA
having SUM(soluong) >= ALL(select SUM(soluong) as TongSL
                           from SANPHAM, CT_HOADON
                           where SANPHAM.MASP=CT_HOADON.MASP_CT
                           group by MASP)
                           
          
--f. Cho danh sách các sản phẩm có doanh thu cao nhất

select MASP,TENSP,SOLUONGTON,MOTA,GIA,SUM(THANHTIEN) as DoanhThu
from SANPHAM,CT_HOADON
where SANPHAM.MASP=CT_HOADON.MASP_CT
group by MASP,TENSP,SOLUONGTON,MOTA,GIA
having SUM(THANHTIEN) >= ALL(select SUM(THANHTIEN) as DoanhThu
                           from SANPHAM, CT_HOADON
                           where SANPHAM.MASP=CT_HOADON.MASP_CT
                           group by MASP)
